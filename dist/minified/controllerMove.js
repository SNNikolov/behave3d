"use strict";Behave3d.controllerMove=function(a){Behave3d.Controller.call(this,a)};Behave3d.controllerMove.prototype=Object.create(Behave3d.Controller.prototype);Behave3d.controllerMove.prototype.events=["start","half","end","start_back","half_back","end_back","pos0","pos1"];Behave3d.controllerMove.prototype.messages=["start","start_back","start_reverse","start_new","start_new_back","pos0","pos1"];Behave3d.controllerMove.prototype.default_params={duration:1000,x:"same",y:"same",z:"same",dx:0,dy:0,dz:0,init_x:0,init_y:0,init_z:0,anti_perspective:0,is_path:!1,half_step:1,spring_acc:0,spring_vdamp:0.92,ease_type:"ease",ease_amount:1,ease_mirror:!1,repeat_start_pos:!1,register_actions:!1};Behave3d.controllerMove.prototype.construct=function(a,b){if(b=="params"){var c=this.getComputedLengths(["init_x"],["init_y"],["init_z"]);this.stepper=new Behave3d.StepEngine({x:c.init_x,y:c.init_y,z:c.init_z},!1,this,this);this.path_pos={x:c.init_x,y:c.init_y,z:c.init_z};this.path_enabled=!1}else if(b=="events"){this.setEventHandlers()}};Behave3d.controllerMove.prototype.message=function(a,b){if(this.handleCommonMessage(a,b))return this;b=this.setMessageParams(a,b);this.direction=a=="start"||a=="start_new"||a=="pos1"||a=="start_reverse"&&this.direction!=1?1:-1;var c=a=="pos0"||a=="pos1"?0:this.duration,d=a=="start_new"||a=="start_new_back",e=b.x!==void 0||b.y!==void 0||b.z!==void 0,f=b.dx!==void 0||b.dy!==void 0||b.dz!==void 0,g=e&&!f,h=!e&&f,i=this.getComputedLengths(["dx"],["dy"],["dz"]),j=this.getComputedLengths(["x"],["y"],["z"],["same"]),k=!g&&(i.dx!=0||!h)?i.dx:j.x==="same"?0:j.x-this.stepper.getVar("x",!0),l=!g&&(i.dy!=0||!h)?i.dy:j.y==="same"?0:j.y-this.stepper.getVar("y",!0),m=!g&&(i.dz!=0||!h)?i.dz:j.z==="same"?0:j.z-this.stepper.getVar("z",!0);this.stepper.start(this.direction,this.repeat_start_pos,d,{x:k,y:l,z:m},c);this.paused=!1;return this};Behave3d.controllerMove.prototype.update=function(){this.stepper.update(this.paused);this.path_pos.x=this.stepper.getVar("x");this.path_pos.y=this.stepper.getVar("y");this.path_pos.z=this.stepper.getVar("z");this.path_enabled=this.stepper.isMoving();if(this.anti_perspective!=0&&this.path_pos.z!=0&&this.owner.element.offsetParent){var a=this.anti_perspective*this.path_pos.z/Behave3d.vars.sceneParams.perspective,b=Behave3d.getElementPos(this.owner.element,!0,!0,!0),c=-b.x+Behave3d.params.getLength("50%v","X"),d=-b.y+Behave3d.params.getLength("50%v","Y");this.path_pos.x+=(c-this.path_pos.x)*a;this.path_pos.y+=(d-this.path_pos.y)*a}if(!this.is_path)this.addTransform({type:Behave3d.transforms.translate,dx:this.path_pos.x,dy:this.path_pos.y,dz:this.path_pos.z})};Behave3d.controllerMove.prototype.setEventHandlers=function(){this.registerActions(this.register_actions,{show:"start_back",hide:"start",show_immediately:"pos0",hide_immediately:"pos1"},{show_start:"start_back",show_end:"end_back",hide_start:"start",hide_end:"end",move_start:"start",move_end:"end"})};Behave3d.registerController("move",Behave3d.controllerMove);