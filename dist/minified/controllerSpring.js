"use strict";Behave3d.controllerSpring=function(a){Behave3d.Controller.call(this,a,!0)};Behave3d.controllerSpring.prototype=Object.create(Behave3d.Controller.prototype);Behave3d.controllerSpring.prototype.default_params={strength:1,max_len:0,fixed_point_id:"",paths:""};Behave3d.controllerSpring.prototype.construct=function(a,b){if(b=="params"){this.setFixedPoint(this.fixed_point_id);this.path_controllers=this.paths!=""?this.paths.split(" "):[];for(var i=0;i<this.path_controllers.length;i++){this.path_controllers[i]=this.getAnotherController(this.path_controllers[i])}}};Behave3d.controllerSpring.prototype.update=function(){if(this.paused)return;var a=this.getTarget(0),b=Behave3d.getElementPos(a.element,!0),c=a.pos;if(this.fixed_point_id!="")this.setFixedPoint(this.fixed_point_id);if(this.paramsHaveChanged()||!this.computed_params)this.computed_params=this.getComputedLengths(["max_len"]);var d=this.path_controllers.length>0?this.getPathPos(this.path_controllers):{x:this.fixed_point.x-b.x+c.x,y:this.fixed_point.y-b.y+c.y,z:this.fixed_point.z-b.z+c.z};this.applySpringForce(d,this.strength,this.computed_params.max_len,0)};Behave3d.controllerSpring.prototype.setFixedPoint=function(a){if(!this.zero_point)this.zero_point=Behave3d.getElementPos(this.owner.element,!0);this.fixed_point=a?Behave3d.getElementPos(a,!0):this.zero_point;this.fixed_point_id=a};Behave3d.registerController("spring",Behave3d.controllerSpring);