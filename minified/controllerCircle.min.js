"use strict";Behave3d.controllerCircle=function(e){Behave3d.Controller.call(this,e)},Behave3d.controllerCircle.prototype=Object.create(Behave3d.Controller.prototype),Behave3d.controllerCircle.prototype.events=["start","half","end","cycle","mark","start_back","half_back","end_back","cycle_back","mark_back","pos0","pos1"],Behave3d.controllerCircle.prototype.messages=["start","start_back","start_reverse","start_new","start_new_back","pos0","pos1"],Behave3d.controllerCircle.prototype.default_params={x_radius:50,y_radius:50,x_center:0,y_center:0,duration:1e3,init_angle:0,angle:0,marked_angle:-1,is_path:!1,half_step:1,spring_acc:0,spring_vdamp:.92,ease_type:"ease",ease_amount:1,ease_mirror:!1,register_actions:!1,repeat_start_pos:!1},Behave3d.controllerCircle.prototype.construct=function(e,t){"params"==t?(this.stepper=new Behave3d.StepEngine({angle:this.init_angle},!0,this,this),this.path_pos={x:0,y:0,z:0},this.path_enabled=!0):"events"==t&&this.setEventHandlers()},Behave3d.controllerCircle.prototype.message=function(e,t){if(this.handleCommonMessage(e,t))return this;t=this.setMessageParams(e,t),this.direction="start"==e||"start_new"==e||"pos1"==e||"start_reverse"==e&&1!=this.direction?1:-1;var s="pos0"==e||"pos1"==e?0:this.duration,a="start_new"==e||"start_new_back"==e;return this.stepper.start(this.direction,this.repeat_start_pos,a,{angle:this.angle},s),this.paused=!1,this},Behave3d.controllerCircle.prototype.update=function(){this.stepper.update(this.paused),(this.paramsHaveChanged()||!this.computed_params)&&(this.computed_params=this.getComputedLengths(["x_radius","x_center"],["y_radius","y_center"])),this.path_pos.x=this.computed_params.x_center+this.computed_params.x_radius*Math.cos(this.stepper.getVar("angle")/Behave3d.consts.RADIANS_TO_UNITS),this.path_pos.y=this.computed_params.y_center+this.computed_params.y_radius*Math.sin(this.stepper.getVar("angle")/Behave3d.consts.RADIANS_TO_UNITS),this.path_enabled=this.stepper.isMoving(),this.is_path||this.addTransform({type:Behave3d.transforms.translate,dx:this.path_pos.x,dy:this.path_pos.y,dz:this.path_pos.z})},Behave3d.controllerCircle.prototype.setEventHandlers=function(){this.registerActions(this.register_actions,{show:"start_back",hide:"start",show_immediately:"pos0",hide_immediately:"pos1"},{show_start:"start_back",show_end:"end_back",hide_start:"start",hide_end:"end"})},Behave3d.registerController("circle",Behave3d.controllerCircle);