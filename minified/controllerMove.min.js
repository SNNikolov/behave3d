"use strict";Behave3d.controllerMove=function(t){Behave3d.Controller.call(this,t)},Behave3d.controllerMove.prototype=Object.create(Behave3d.Controller.prototype),Behave3d.controllerMove.prototype.events=["start","half","end","start_back","half_back","end_back","pos0","pos1"],Behave3d.controllerMove.prototype.messages=["start","start_back","start_reverse","start_new","start_new_back","pos0","pos1"],Behave3d.controllerMove.prototype.default_params={duration:1e3,x:"same",y:"same",z:"same",dx:0,dy:0,dz:0,init_x:0,init_y:0,init_z:0,is_path:!1,half_step:1,spring_acc:0,spring_vdamp:.92,ease_type:"ease",ease_amount:1,ease_mirror:!1,repeat_start_pos:!1,register_actions:!1},Behave3d.controllerMove.prototype.construct=function(t,e){if("params"==e){var s=this.getComputedLengths(["init_x"],["init_y"],["init_z"]);this.stepper=new Behave3d.StepEngine({x:s.init_x,y:s.init_y,z:s.init_z},!1,this,this),this.path_pos={x:s.init_x,y:s.init_y,z:s.init_z},this.path_enabled=!1}else"events"==e&&this.setEventHandlers()},Behave3d.controllerMove.prototype.message=function(t,e){if(this.handleCommonMessage(t,e))return this;e=this.setMessageParams(t,e),this.direction="start"==t||"start_new"==t||"pos1"==t||"start_reverse"==t&&1!=this.direction?1:-1;var s="pos0"==t||"pos1"==t?0:this.duration,a="start_new"==t||"start_new_back"==t,r=void 0!==e.x||void 0!==e.y||void 0!==e.z,i=void 0!==e.dx||void 0!==e.dy||void 0!==e.dz,o=r&&!i,p=!r&&i,h=this.getComputedLengths(["dx"],["dy"],["dz"]),n=this.getComputedLengths(["x"],["y"],["z"],["same"]),d=o||0==h.dx&&p?"same"===n.x?0:n.x-this.stepper.getVar("x",!0):h.dx,_=o||0==h.dy&&p?"same"===n.y?0:n.y-this.stepper.getVar("y",!0):h.dy,v=o||0==h.dz&&p?"same"===n.z?0:n.z-this.stepper.getVar("z",!0):h.dz;return this.stepper.start(this.direction,this.repeat_start_pos,a,{x:d,y:_,z:v},s),this.paused=!1,this},Behave3d.controllerMove.prototype.update=function(){this.stepper.update(this.paused),this.path_pos.x=this.stepper.getVar("x"),this.path_pos.y=this.stepper.getVar("y"),this.path_pos.z=this.stepper.getVar("z"),this.path_enabled=this.stepper.isMoving(),this.is_path||this.addTransform({type:Behave3d.transforms.translate,dx:this.path_pos.x,dy:this.path_pos.y,dz:this.path_pos.z})},Behave3d.controllerMove.prototype.setEventHandlers=function(){this.registerActions(this.register_actions,{show:"start_back",hide:"start",show_immediately:"pos0",hide_immediately:"pos1"},{show_start:"start_back",show_end:"end_back",hide_start:"start",hide_end:"end",move_start:"start",move_end:"end"})},Behave3d.registerController("move",Behave3d.controllerMove);