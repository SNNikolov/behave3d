"use strict";Behave3d.controllerSpring=function(t){Behave3d.Controller.call(this,t,!0)},Behave3d.controllerSpring.prototype=Object.create(Behave3d.Controller.prototype),Behave3d.controllerSpring.prototype.default_params={strength:1,max_len:0,fixed_point_id:"",paths:""},Behave3d.controllerSpring.prototype.construct=function(t,e){if("params"==e){this.setFixedPoint(this.fixed_point_id),this.path_controllers=""!=this.paths?this.paths.split(" "):[];for(var i=0;i<this.path_controllers.length;i++)this.path_controllers[i]=this.getAnotherController(this.path_controllers[i])}},Behave3d.controllerSpring.prototype.update=function(){if(!this.paused){var t=this.getTarget(0),e=Behave3d.getElementPos(t.element,!0),i=t.pos;""!=this.fixed_point_id&&this.setFixedPoint(this.fixed_point_id),(this.paramsHaveChanged()||!this.computed_params)&&(this.computed_params=this.getComputedLengths(["max_len"]));var o=this.path_controllers.length>0?this.getPathPos(this.path_controllers):{x:this.fixed_point.x-e.x+i.x,y:this.fixed_point.y-e.y+i.y,z:this.fixed_point.z-e.z+i.z};this.applySpringForce(o,this.strength,this.computed_params.max_len,0)}},Behave3d.controllerSpring.prototype.setFixedPoint=function(t){this.zero_point||(this.zero_point=Behave3d.getElementPos(this.owner.element,!0)),this.fixed_point=t?Behave3d.getElementPos(t,!0):this.zero_point,this.fixed_point_id=t},Behave3d.registerController("spring",Behave3d.controllerSpring);