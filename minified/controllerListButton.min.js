"use strict";Behave3d.controllerListButton=function(t){Behave3d.Controller.call(this,t)},Behave3d.controllerListButton.prototype=Object.create(Behave3d.Controller.prototype),Behave3d.controllerListButton.prototype.requires={controllers:["controllerList","controllerMove","controllerOpacity"]},Behave3d.controllerListButton.prototype.messages=["update","click"],Behave3d.controllerListButton.prototype.events=["click","border_reached","border_left","no_progress"],Behave3d.controllerListButton.prototype.default_params={list:"",action:"",action_pos:-1,action_step:0,when_no_progress:"fire",when_on_border:"fire",when_clicked:"fire",back_delay:200,alt_class:""},Behave3d.controllerListButton.prototype.construct=function(t,e){"params"==e?this.handlers_set_for_list="":"events"==e&&this.setEventHandlers()},Behave3d.controllerListButton.prototype.destruct=function(){},Behave3d.controllerListButton.prototype.message=function(t,e){if(this.handleCommonMessage(t,e))return this;if(e=this.setMessageParams(t,e),"update"==t)this.list||Behave3d.debugExist(this.debugName()+" cannot update because its property 'list' is not set"),this.setEventHandlers();else if("click"==t){if(this.action){var s={};-1!=this.action_pos&&(s.pos=this.action_pos),0!=this.action_step&&(s.step=this.action_step),this.list_ref.message(this.action,s)}this.doReaction(this.when_clicked,"click")}return this},Behave3d.controllerListButton.prototype.setEventHandlers=function(){if(this.list!=this.handlers_set_for_list&&(this.on(this.list+" all",this.handlerOfListEvents.bind(this)),this.handlers_set_for_list=this.list,this.list_ref=this.getAnotherController(this.list)),!this.targets_events_handled){this.targets_events_handled=!0;for(var t=this,e=0;e<this.targets.length;e++)this.targets[e].addEventListener("click",function(){t.message("click")})}},Behave3d.controllerListButton.prototype.doReaction=function(t,e,s){if(t){!s&&"fire"!=t&&["click","no_prev","no_next"].indexOf(e)>=0&&setTimeout(function(){this.doReaction(t,!0,e)}.bind(this),this.back_delay);for(var o=t.trim().split(" "),i=0;i<o.length;i++)switch(o[i]){case"change_class":this.alt_class?s?this.owner.element.classList.remove(this.alt_class):this.owner.element.classList.add(this.alt_class):Behave3d.debugExit(this.debugName()+" must perform 'change_class' but its param alt_class is not set");break;case"disable":this.owner.element.disabled=!s;break;case"fire":s&&"border_left"!=e||this.fireEvent(e)}}},Behave3d.controllerListButton.prototype.handlerOfListEvents=function(t,e){switch(t){case"first_reached":"focus_next"!=this.action&&this.doReaction(this.when_on_border,"border_reached");break;case"last_reached":"focus_prev"!=this.action&&this.doReaction(this.when_on_border,"border_reached");break;case"border_left":this.doReaction(this.when_on_border,"border_left",!0);break;case"no_prev":case"no_next":this.action!=("no_prev"==t?"focus_next":"focus_prev")&&this.doReaction(this.when_no_progress,"no_progress")}},Behave3d.registerController("listButton",Behave3d.controllerListButton);